# PR-97: Fix TypeScript errors in `core/systemContext.ts`

## Title
Fix TypeScript errors in core/systemContext.ts and related files

## Goal (RU)
Починить все существующие TypeScript-ошибки в ядре, которые ломают `npm run check`, без изменения поведения системы, только за счёт аккуратной правки типов и сигнатур.

## Goal (EN)
Fix all existing TypeScript errors in the core so that `npm run check` passes, without changing runtime behavior, only via proper typing and signatures.

---

## Scope
1. Найти и исправить все TS-ошибки, из-за которых падает:
   - `npm run check`
2. Основной модуль, который сейчас ломается:
   - `src/core/systemContext.ts`
3. Также поправить связанные файлы, если ошибки «растянулись» по типам:
   - любые файлы, которые импортируют/экспортируют сущности из `systemContext.ts`
   - любые общие типы, которые используются там же

---

## Requirements
1. Не менять бизнес-логику.
   - Не переписывать алгоритмы.
   - Не менять поведение функций (только типы и сигнатуры так, чтобы они соответствовали фактическому использованию).
2. Фокус на типах:
   - Явно описать интерфейсы и типы контекстов, где сейчас `any` или слишком широкие типы ломают проверку.
   - Если нужно ослабить тип (например, `T | undefined`), делаем это осознанно и документируем одним коротким комментарием.
   - Не добавлять `any`, кроме случаев, когда это реально единственный вариант (и тогда обязательно короткий комментарий `// TODO: narrow this type later`).
3. Поддержать существующую архитектуру:
   - Не менять публичные имена экспортов.
   - Не ломать существующие импорты.
4. Сделать так, чтобы:
   - `npm run check` проходил без ошибок.

---

## Acceptance Criteria
1. Команда `npm run check` выполняется без ошибок TypeScript.
2. Не изменены:
   - публичные API модулей (имена функций/классов/экспортов),
   - поведение рантайма (только типы и сигнатуры).
3. Код остаётся читаемым:
   - типы названы понятно,
   - отсутствуют «магические» `any` без комментариев.
4. В описании PR кратко перечислены:
   - какие файлы затронуты,
   - какие основные типы были введены/уточнены.

---

## Optional (nice to have)
- Если это уместно и не раздувает PR:
  - вынести общие типы в отдельный файл `src/core/types/systemTypes.ts` или похожий;
  - добавить 1–2 маленьких юнит-теста, если это помогает зафиксировать сигнатуры (но это не обязательно).

---

## Context for L21 Flow Dashboard
После того как Codex сделает этот PR-97:
1. Смёржить его в `main`.
2. Запустить у себя:
   - `npm install`
   - `npm run check`
3. Убедиться, что TypeScript чистый.
4. После этого можно мёржить PR-96 с L21 Flow Dashboard без красных ошибок.

---

## Next Steps (optional suggestions)
- Можно дать текст мини-задачи для Codex по доработке L21-дашборда (цвета, метрики, демо-данные).
- Или придумать первую «живую» метрику удачи/потока, чтобы сразу было что смотреть на графиках.
