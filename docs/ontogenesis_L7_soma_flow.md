# LIMINAL Ontogenesis — L7: SomaFlow (кровообращение смыслов)

L7 добавляет слой **циркуляции потоков** между осями L (личное), S (социальное) и C (космическое).
После того как система научилась видеть баланс (L0), связи (ACL), сглаживать состояние (мозжечок) и запускать волны (L6),
SomaFlow отвечает на вопрос:

> «Куда реально текут силы прямо сейчас?»

## Основные сущности

- `AxisFlow` — состояние потока по одной оси:
  - `inflow` / `outflow` / `netFlow` — приток, отдача и баланс ресурса,
  - `pressure` — давление/перегрузка,
  - `stagnation` — застой (почти нет движения при наличии нагрузки),
  - `fatigueRisk` — риск усталости/выгорания,
  - `nourishment` — здоровое питание оси,
  - `role` — текущая роль: донор / реципиент / баланс.

- `SomaFlowSnapshot` — общий снимок:
  - `flows.L/S/C` — подробности по каждой оси,
  - `globalPressureIndex`, `globalStagnationIndex`, `globalFatigueRisk`, `globalNourishmentIndex`,
  - `suggestedShift` — мягкая рекомендация, между какими осями сместить фокус.

## Как считается

`computeSomaFlow(...)` принимает:
- `OrientationSnapshot` (L0),
- `LoadProfile` (L0),
- `CerebellumSnapshot` (L0),
- `AxisCouplingSnapshot` (ACL),
- `ResonanceSnapshot` (L6),
и возвращает `SomaFlowSnapshot`.

Простая эвристика:
- активность оси берётся из текущего профиля нагрузки и ритмов L6,
- поддержка усиливается связями ACL (direct/holding/baseline) и энергией волны,
- давление растёт, если отдача выше притока; застой — если баланс близок к нулю при высокой активности,
- риск усталости учитывает давление, застой и верхнюю границу здоровой нагрузки (`maxHealthyPressure`),
- `suggestedShift` предлагает смещение от перегруженных осей к недокормленным.

## Конфигурация

`FlowConfig` управляет чувствительностью и наградами:
- `sensitivity`, `fatigueGain`, `nourishmentGain` — как быстро растут давление/усталость и как вознаграждается питание,
- `maxHealthyPressure` — верхняя граница «здорового» давления,
- `resonanceImpact` — насколько энергия волн L6 усиливает потоки,
- `couplingImpact` — насколько связи ACL распределяют ресурс.

Значения по умолчанию заданы в `DEFAULT_FLOW_CONFIG`.

## Интерпретация

- Высокий `pressure` + низкий `nourishment` на L → перегруз личного без подпитки.
- Высокий `pressure` на S + большой `outflow` → отдаём слишком много в социум.
- Низкий `inflow` на C → космическая ось «голодает», горизонта мало.

`globalPressureIndex` и `globalStagnationIndex` помогают увидеть общее состояние,
а `suggestedShift` — куда мягко перераспределить фокус.

## Встраивание

L7 считается после L6 и добавляется в ontogenesis snapshot в поле `flow`.
Через `/api/system/ontogenesis` и таймлайн можно видеть, как меняется
давление/питание по осям во времени.

